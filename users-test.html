<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Data to Table</title>
</head>

<body>
    <table id="userTable" border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Password</th>
                <th>Enable User</th>
                <th>Service ID</th>
                <th>Group ID</th>
                <th>First Name</th>
                <th>Address</th>
                <th>Phone</th>
                <th>SN</th>
                <th>Comment</th>
                <th>Created At</th>
                <th>Updated At</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be inserted here -->
        </tbody>
    </table>

    <script>
        // URL API
      // Fungsi untuk mengubah format tanggal dan waktu
        function formatDateTimeToJakartaTime(dateTimeStr) {
            const options = { timeZone: 'Asia/Jakarta', year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const dateTime = new Date(dateTimeStr);
            return dateTime.toLocaleString('id-ID', options);
        }

        // URL API
        const apiUrl = "http://127.0.0.1:8000/api/radius/users";

        // Select the table body
        const tableBody = document.querySelector("#userTable tbody");

        // Fetch data from the API
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                // Loop through the data and create rows in the table
                data.message.forEach(user => {
                    // Ubah format tanggal dan waktu
                    user.created_at = formatDateTimeToJakartaTime(user.created_at);
                    user.updated_at = formatDateTimeToJakartaTime(user.updated_at);

                    // Buat baris tabel
                    const row = document.createElement("tr");
                    row.innerHTML = `
                <td>${user.id}</td>
                <td>${user.username}</td>
                <td>${user.password}</td>
                <td>${user.enableuser}</td>
                <td>${user.svrid}</td>
                <td>${user.groupid}</td>
                <td>${user.firstname}</td>
                <td>${user.address}</td>
                <td>${user.phone}</td>
                <td>${user.SN}</td>
                <td>${user.comment}</td>
                <td>${user.created_at}</td>
                <td>${user.updated_at}</td>
            `;
                    tableBody.appendChild(row);
                });
            })
            .catch(error => {
                console.error("Error fetching data:", error);
            });

    </script>
</body>

</html>